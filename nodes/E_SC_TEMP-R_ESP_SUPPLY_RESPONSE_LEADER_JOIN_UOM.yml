fileVersion: 1
id: 373c56da-53f2-444a-ad54-4821e273fdff
name: R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_UOM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_TEMP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79231045-7ff9-4478-b607-f0610763960a
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: FLOAT
        description: ""
        name: FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ca114fd-3168-431b-bd3c-517dd01b02c1
                stepCounter: 553aafcc-ef68-4a4e-82d5-4979619bac55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8156f19-2bc0-4700-a5e0-a2ec51bec2f9
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: UNIT_OF_MEASURE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10a04ef2-bc4d-43af-bbc6-aa8e631e61e2
                stepCounter: 553aafcc-ef68-4a4e-82d5-4979619bac55
            transform: coalesce("R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW"."UNIT_OF_MEASURE", 'Units')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3a04a50-6fa3-47a9-97ee-de300ed84912
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(9)
        description: ""
        name: PLANNING_WORKWK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2af00de-607a-40da-9723-4afb837cc169
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e15f8220-21f7-41e3-922c-f447d54747e5
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64d36b41-833c-48d2-aff9-f74bdd066e10
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b245ddb-e858-4a85-90d6-b77c8e449e23
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: DATE
        description: ""
        name: SCENARIO_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea34ebd9-c0d5-403d-87a2-0f74b9d87ecb
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ab4c5cc-e507-417b-8ab9-38e1ad4c561e
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SCENARIO_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 615bfe2f-edbd-41b1-8246-c33b839a27bd
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff51f174-826e-4fd6-8e9f-2e4981c4145b
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DATETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ffb2763-278d-4409-bf13-b775903f515d
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d3d3142-98d2-4515-821b-b78815c0571a
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PLANNING_FMON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5add6ed0-58ea-431c-a192-ae34c855e7ee
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a0a8d98-0341-4503-82c0-d451fd39edc8
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: PLANNING_FQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51a37cf0-0f42-4f55-bc08-3b83994645ae
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab532618-1744-4177-b548-180f520e0638
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: PLANNING_FISCAL_YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6551eb06-7c0a-4ca6-b03c-3ad6ca304481
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11a0fc78-c829-4b91-82dc-cf3d3054b174
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: PLANNING_WW_BEGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a23bfc-3dec-4f6b-83f3-c67dc15a99a0
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c48799b-53f9-451a-8102-0606623ae3bd
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: PLANNING_WW_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdbada15-1e99-4d36-b280-6ca9c6728dbc
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91294308-95f4-4f6a-bb1c-6e42056f8860
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: DMDNEEDQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ea6029c-be69-4f3e-832c-8f46c65219ee
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76517fe9-41a2-4ec2-8fe9-2c8d2f1d10e4
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SUPPLYPEGQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 706cd713-fae6-4025-b525-a2efb06049c7
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a701ae6-3cc7-4ea1-b830-83cf67568693
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: CUMULATIVE_DMDNEEDQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc686a53-0334-4338-b0f2-ba63c9f85925
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3978fe8-7e9d-44de-9c19-5f446da07183
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: CUMULATIVE_SUPPLYQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 754b14e9-6779-4894-af4a-e7cda3208dc3
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d771b8-5d08-41cd-afb5-20082deae95a
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LOAD_DATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cd5eb01-79a0-424c-9a00-85539be9ecd3
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5597c00f-60e3-4638-bed6-257f9d6ed160
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: U_INDDMD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b0b369-1b24-449b-946e-cf53977dd54f
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 278d8421-cf1a-48b1-8706-69290f6998d4
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: DATE
        description: ""
        name: CURRENT_DATE_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 615b7171-6467-48db-9a68-9809bfb8a26b
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed9dc7b-fd1d-40fd-acc9-190a165bdf67
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PROFIT_CENTER_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8db93216-9a0f-4f73-8c58-076b30630b34
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fe36dc1-8f3d-4f85-8a1f-8ade43e9a5de
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: SC_SUB_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c59ca2e-79fc-486b-85b4-7e9134c07340
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59c8b617-f088-4090-a3b3-7a2dbdf9cb91
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: FINANCE_BUSINESS_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7ac84a4-0d11-434a-9953-f98f35aa731c
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1e11b35-b398-4b29-b55a-29700a943ddd
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PLANNING_FQ_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede20cde-2724-4dfe-ae04-ee40f82513fe
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f77904e2-8c81-428e-8824-e75ed19b1b86
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PLANNING_FMON_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88943c9c-2381-42be-90dc-5211c5802603
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27b764c3-51ed-4550-9b3c-211129f8823c
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PRODUCT_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65b6d998-eb0c-4f55-abb7-d628324c2e55
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b594e56e-19c0-4027-a59a-000267c5366c
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PRODUCT_SUBTECHNOLOGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e934d75-dc75-48f4-9326-2a2d5383728d
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b8bf5df-66fb-47f5-804e-15e3969e2bdf
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SHORTAGE_NEW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59dff7eb-4972-490d-a8ef-785cb0a74996
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82bc8c4f-bb11-4073-aa84-cdb4d6873b8a
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: MODULE_COMPONENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16596f0-c2d1-4967-9a64-4b4daf475d81
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b9001d4-35d4-49d6-b28d-0f03cd690d63
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CONFIGURATION_WIDTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71a4b49b-eba8-4b80-979c-bcffe7dc3373
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69026e36-5770-46c7-a96d-14c5ce305100
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: RETAIL_BOUND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05b42a6b-5784-4f05-9d9b-01a19457ab39
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23c46816-81c8-4f3f-b883-72f33db979e3
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: CUMULATIVE_SHIPMENTQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0fe462f-2c70-46fa-aa65-d8d392eb9d8c
                stepCounter: 52915f0b-be28-4d6a-b2ce-0434fb247674
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 72985172-18a7-484d-997a-83990a5123d1
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CUM_DEMAND_NEED_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_DMDNEEDQTY"  * "FACTOR") ) )
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aa1393d4-7676-4555-9f47-691f8fc96917
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CUM_SUPPLY_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SUPPLYQTY"  * "FACTOR") ) )
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cfc74dcb-2e27-4995-9dfc-8a153e4f874f
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: DEMAND_NEED_QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."DMDNEEDQTY"  * "FACTOR") ) )
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c6745b8c-ad5c-4527-8aed-0ae9a15dde8f
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: SUPPLY_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SUPPLYPEGQTY"  * "FACTOR") ) )
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4d91b9b7-a443-41a6-82c3-2b46a6ab3be6
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: SHORTAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."SHORTAGE_NEW"  * "FACTOR") ) )
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8dbaef27-2ca6-4a76-991f-60f8d49d3e66
          stepCounter: 373c56da-53f2-444a-ad54-4821e273fdff
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CUM_SHIPMENT_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              IFF("UNIT_OF_MEASURE1" = 'Units', "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY",

              IFF("UNIT_OF_MEASURE1"='GBIT_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY" * "FACTOR",0)

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY" * "FACTOR"*8,0),
               
              IFF("UNIT_OF_MEASURE1"='GBYTE_EQUIVS_QTY',

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBIT%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY"  * "FACTOR",0) 

              + 

              IFF(UPPER("UNIT_OF_MEASURE1") LIKE 'GBYTE%',"R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY" * "FACTOR"*8,0)/8,

              "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."CUMULATIVE_SHIPMENTQTY"  * "FACTOR") ) )
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR: 52915f0b-be28-4d6a-b2ce-0434fb247674
          R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW: 553aafcc-ef68-4a4e-82d5-4979619bac55
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR
          - locationName: E_SC_TEMP
            nodeName: R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW
        join:
          joinCondition: |-
            FROM {{ ref('E_SC_TEMP', 'R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR') }} "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"
            LEFT OUTER JOIN {{ ref('E_SC_TEMP', 'R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW') }} "R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW"
            ON "R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_MATERIAL_CHAR"."ITEM" = "R_ESP_SUPPLY_RESPONSE_LEADER_UOM_VIEW"."MATERIAL" 
        name: R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_UOM
        noLinkRefs: []
  name: R_ESP_SUPPLY_RESPONSE_LEADER_JOIN_UOM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
