fileVersion: 1
id: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
name: F_BOM_ASSEMBLY_ANALYSIS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_MP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 328ec266-b3d1-44c3-9f4f-10c36ea32370
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94578e7e-86c9-43da-8ea2-d21cfe3b13a4
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82b64946-1148-401c-9cd5-88dc3a43de26
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MPN_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89b636c2-2c58-424f-b67e-cb31bb37ea75
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48a39b15-3209-418c-82d6-2bffef79158e
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: AOUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da054c9-0a87-4e02-9a17-8aa36934a6ad
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 168a3f0e-03c1-4b7b-a9dd-301467ad0750
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: AOUT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a8ee9af-6960-4f05-8c26-d7cdde6af7d3
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 566e7ba4-5ec2-4415-8a86-16edbc3e9e56
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: APID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58daf914-6904-4c09-aa1a-6016dce50d64
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9866318-113d-4f77-aef1-f0490bcd8f69
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(150)
        description: ""
        hashDetails: null
        name: APID_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e5d34cc-e3ae-43c0-8e8f-ae20456cb4d5
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b38d7256-1c9e-40c8-b537-707be937af15
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: COMPONENT_MATERIAL_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6892bf5-710d-4c68-8292-b51fb4787575
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc01e349-280d-4953-9042-b3023122064f
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MATERIAL_PART_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5c54142-b044-4e2c-8b40-26eed000fce2
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a7ac827-5055-4378-a2d3-8fc10da896f9
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: MATERIAL_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cea547b4-f565-4f94-bbe4-ff779cac57bc
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 884f91af-41f9-4d38-9d73-ffde31d3a0cc
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: SITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce90f2b8-6eb4-473d-b6bf-aba4fd64da2c
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6573ff-8f11-4820-95e0-3f43a1b275ee
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: NUMBER(24,4)
        description: ""
        hashDetails: null
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2627fd30-c58b-4873-8410-be845c2196a5
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: AVG("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."USAGE_QTY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f9fedea-1440-4175-8ba3-3bb516e50373
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: TFGPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88e2b5a7-af3e-4adb-90ac-a3278df17ec0
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 047cd0dd-93e7-42c1-bd85-b0cd982647c9
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: TFGPN_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a84fc88-d098-42a3-a6b6-425843530992
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 695a58ff-32c2-46b4-a6ba-e6c50453ca3f
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MATERIAL_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 102e4b97-4471-44b6-8afe-a88ebea240ab
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e49584d-4471-4c7a-b96f-5e6ff5f4b8a9
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MATERIAL_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 102e4b97-4471-44b6-8afe-a88ebea240ab
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e7ea7a-68ba-4b46-a177-30ea1cf82194
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(9)
        description: ""
        hashDetails: null
        name: PARENT_MATERIAL_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d3c4628-e210-437b-b609-bbbd0f43afbe
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fff53dd-71f5-4825-b1d3-02d74ab3b184
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: DID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89622ab2-4fc5-460a-a898-dbd4c590a423
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5678b034-010d-4d66-a5e0-66eebd90978c
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: PROJECT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 700958bb-7bb5-4c57-8e89-f6c6a71e42d3
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fc0387e-c563-4a70-ba9b-d1fa1870b8e7
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: LEAD_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df719301-29f6-4fe1-b655-5286f705f8ca
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 217cee15-b66e-4696-b667-eacc6f887320
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: DIE_IN_PACKAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25d89f1e-cfb3-4846-9f0f-c716a85de3e5
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06132e8d-fabd-4a53-b81d-b347412ac8f5
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 356271f8-d2a1-4b1c-ba1e-1593b13469c3
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ac8857d-386f-4aca-ab3a-bb5ea7ccd5e8
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(2)
        description: ""
        hashDetails: null
        name: PRODUCT_PHASE_GATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92619933-f51e-4b02-bf1f-9f3a9854b67e
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba4eea27-d60f-47dc-a564-be0f19d2341f
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        hashDetails: null
        name: PACKAGE_LENGTH_WIDTH_HEIGHT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f683f5e-94b2-46b9-9913-9dcc2718f830
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16180d97-0841-4b8b-80ac-5be194abb7b0
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(2)
        description: ""
        hashDetails: null
        name: MRP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc198ca8-d65f-4505-9a11-5be071669ac5
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb14f5b8-63ba-4e7f-a78a-d1c4f09bc54c
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: NUMBER(11,3)
        description: ""
        hashDetails: null
        name: UNIQUE_COST_IN_USD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e127be-06c2-4d36-aaa1-7ff5a6b90d9a
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: SUM("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."UNIQUE_COST_IN_USD")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5cad550-f56c-49a9-9e54-abbb169f18bc
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(3)
        description: ""
        hashDetails: null
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61f254ca-7799-4181-92f0-17df75fce470
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a9ebaf3-bbd8-404b-b632-e41f10df693f
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: NUMBER(11,3)
        description: ""
        hashDetails: null
        name: LEAD_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66698917-dfce-4f13-b3c7-2fd7d7e7ffce
                stepCounter: e9ac5141-bb23-4540-9c2b-3e2dfba481f1
            transform: SUM("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."LEAD_TIME_ROUNDING")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a74bd6-af90-456c-b2ee-8bb5de07d724
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: RAW_MATERIAL_STATUS_GATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a658ed6-7591-4c5e-a3d9-74e594b183cb
                stepCounter: e7fce5f0-8de2-4bf3-bd8e-67ae65b885e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bead8ae5-4323-431c-bce8-6054ba10aebc
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: NUMBER(5,2)
        description: ""
        name: PRODUCT_SCRAP_FACTOR
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e70c5c64-a8e6-4979-a046-7544a61069ff
                stepCounter: e7fce5f0-8de2-4bf3-bd8e-67ae65b885e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0af79294-77a1-4b86-9768-7d8fb3ac5efb
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: NUMBER(5,2)
        description: ""
        name: SCRAP_FACTOR
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f795103d-7817-48f8-8096-fa3f34fe49a6
                stepCounter: e7fce5f0-8de2-4bf3-bd8e-67ae65b885e6
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 60a9e377-ce60-47f1-94c7-639256696470
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                    WHEN REGEXP_INSTR("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."APID_DESC",'-')>0 THEN LEFT("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."APID_DESC",(REGEXP_INSTR("F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."APID_DESC",'-')-1))
                  ELSE
                      "F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."APID_DESC"
                  END
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ffe717a9-09bc-4767-8578-3d91ee898c6d
          stepCounter: ef43b85f-3c6e-49d5-bcb7-d29380a44c06
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: BILL_OF_MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN
          - locationName: R_SAP_ECC
            nodeName: V_MARC
        join:
          joinCondition: |-
            FROM {{ ref('E_SC_TEMP', 'F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN') }} "F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"
            LEFT OUTER JOIN {{ ref('R_SAP_ECC', 'V_MARC') }} "V_MARC"
            ON "F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."MATERIAL_NUMBER" = "V_MARC"."MATNR"
            AND "F_BOM_ASSEMBLY_ANALYSIS_JOINING_PRODUCT_PART_JOIN_AND_MATERIAL_PLANT_JOIN"."SITE" = "V_MARC"."WERKS"
            group by all;
        name: F_BOM_ASSEMBLY_ANALYSIS
        noLinkRefs: []
  name: F_BOM_ASSEMBLY_ANALYSIS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
