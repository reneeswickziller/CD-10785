fileVersion: 1
id: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
name: DMDRES_LT_COMMON
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_TEMP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd9a889d-6c46-407f-bce0-37c33a0ce13e
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: SNAPSHOTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48a1b7b9-065d-4c66-bb44-9d990b807400
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e1c253f-45ee-4518-9d46-6f8bad5af131
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SCENARIO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 262922be-4399-4e40-a5ea-3eb1dd0d975e
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4ff992c-9e2d-4a98-9a33-512973165fe5
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c98b21d-5424-4c2a-96dd-8ac11ba919c4
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e93a94a-26c9-40e7-949f-f877ed6578dc
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: NEEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bd37dd1-dbbe-4049-9a25-d42a3f937154
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a28da1a2-581d-463d-bca7-74b4e4be9ac7
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: LOCATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a551ce46-1e77-42a0-bd50-7d669b180b01
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab00bc56-e7b0-48b8-b19e-5e97a288b14d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LOADDATETIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97369897-cfbf-4d2b-a7b4-f4804651cbe1
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7f145c1-1141-46e4-8bc0-170347a9d0e8
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(18)
        description: ""
        name: ITEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa86b388-8417-4e25-874c-102de4155bf3
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6062143d-2d02-4126-aabe-38f71803b9b6
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: SCHEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3eb5131-565f-448a-b841-313d8b88552b
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0070a40-6f21-4b7f-a463-9708fbe4805e
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SCHEDQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94e51236-50f4-4d98-b68e-9553622fe205
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ef970df-7c14-4b3f-b02a-9a793ba07ddb
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b32b5b0-b521-4985-897d-53168d3a2e07
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3956946a-3688-4748-940f-27f1f2e4357d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SCHEDSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4994f0b-bbac-40ef-9738-682c377c9a13
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee1271c-ecf4-4543-ac12-d90262692192
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DMDTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa5aa4ef-8a11-4b49-9193-f0e40e30ef2f
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93fc9e48-ff6a-49fb-b417-728c53ef5e5a
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_SUB_SEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c3f208-aa1e-4184-a7b9-3f2630b064e3
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc004d4a-b08c-4fd4-a60f-6250f4136d6d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_CUSTOMER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c69fe01-0700-43fe-b4c9-33311cc59e25
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b93e4ee-4206-421f-8865-6cecc2ffc3f5
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: REQDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a327db-a2e4-43e7-a8a1-077cc8cfbe96
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924f9a34-1311-4a2b-868a-338625715b6f
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,9)
        description: ""
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89ad5bca-75aa-4a61-bd66-43f0d37d6680
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f865597f-a5ec-453e-a68f-e6ea3813918d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_ATP_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce0c80d7-5f10-4a4f-8ea5-59f82f79dc6e
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcd2da71-5b20-455d-b844-ef2151aeb52d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: U_INDDMD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d5e3557-1eb0-43c9-9cb3-de845c897233
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f97fc1-5d45-4474-9dad-c466ec7049dc
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: OFFSETNEEDDT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f64b3ed9-7f80-4ef8-8c15-9d525d18b70d
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e18fd411-29fd-4707-bed6-f86732de8b54
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: DATE
        description: ""
        name: OFFSETREQDT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e5c0058-b79f-4ea0-9bd3-da5ef49d55e3
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3e94056-ec40-43c7-b5a8-d74cce02a12e
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: DELAYEDQUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12dab994-213d-41e0-b291-0636b12bddf1
                stepCounter: 24fe548a-f730-4eef-a74b-de17055cbe0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9f072d7-48e9-40ce-adce-6dc55181ff15
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: SUPPLYTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eec6f18-cc08-4118-88b9-5e2ce19ce8b2
                stepCounter: 4142f568-0526-481d-b037-fe8d9e229390
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bcfbbf1a-a25e-4f9e-814f-caf1abe38516
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        defaultValue: ""
        description: ""
        name: UNMETQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ABS("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY")
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d608bdf-e849-4446-81b1-80eb8f5f470f
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: REQTIMELYQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 126b568f-4545-4400-943b-80dbcd8caf93
                stepCounter: 7f9d1251-9794-43be-a030-fa3e0c9055ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a8421f-7f33-48de-9a86-976dd16483a4
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: REQDELAYEDQUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d268d89-2f60-49da-8ac5-9f0fe2bf4978
                stepCounter: e84718b3-5120-4987-8c2a-e9b1d787080f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c15e26e1-3cb4-4625-bcde-12c9a574c450
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: OFFSETREQDELAYEDQUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f19548a9-c9c1-4301-bbb2-bc5bd91fd676
                stepCounter: 0b261d61-03ee-48e9-a923-1655e5ab108d
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 335616df-5934-44ce-a096-23e645abdac1
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        defaultValue: ""
        description: ""
        name: OFFSETUNMETQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ABS("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY")
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 58ff4b19-35a2-4bbc-89ee-112bbebd5a5b
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        defaultValue: ""
        description: ""
        name: REQUNMETQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ABS("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY")
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a1be08-2fe1-40de-8858-29d525f84638
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: U_PPLEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f0bef8-d41e-415e-88e6-c4e02f488179
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f73463b0-0a61-41dd-bf93-36136a362cb1
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: OFFSETNEEDTIMELYQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5e283aa-a30a-4596-9ddf-8db525d0f508
                stepCounter: 9c2c9c34-c26a-4f59-8238-5a42451f9eed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb5db2da-d641-4951-9517-d7db58787540
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: OFFSETREQTIMELYQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b72017-8cf2-4371-86f2-97cd2c192e9e
                stepCounter: 45c9ab5f-1d0b-4bf0-9076-a4c73d55178f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c120b7e0-74fa-44f5-8b42-69b6a6490163
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: OFFSETNEEDDELAYEDQUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67a982bc-27b4-4d23-a11d-2fd0f07ccb18
                stepCounter: b408ef1c-9c0b-4818-89cb-d66e77706133
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13f61751-ef35-45bf-a4ec-3b94bd33a623
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_SEGMENTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48ff7fd9-696e-4b89-bfb7-2c999492d7fe
                stepCounter: f3264f49-0e27-4db0-af51-10b8f65e49e5
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f5175699-862e-4e19-bf02-4b6b38043f83
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        defaultValue: ""
        description: ""
        name: OFFSETREQUNMETQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ABS("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY")
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fc73de9d-93e5-4a52-84f8-c99d2ae91c92
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INVENTORYFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "DMDRES_LV_INDDMDLINK"."SUPPLYTYPE"='7' THEN 'X' ELSE '' END
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ad14df27-08a6-4675-8c91-d3a0850a2a0d
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OFFSET_NEEDSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN "DMDRES_LT_ORDER"."SCHEDQTY" = 0 THEN 'NOT MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY") >0 THEN 'PARTIALLY MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."OFFSETNEEDDT","DMDRES_LT_ORDER"."SCHEDDATE") > 0 THEN 'MET LATE' 
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."SCHEDDATE","DMDRES_LT_ORDER"."OFFSETNEEDDT") > 0 AND "DMDRES_LV_INDDMDLINK"."SUPPLYTYPE" <> '7' THEN 'MET EARLY' 
              ELSE 'MET' 
              END
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a8d0294c-b7e2-4d13-b569-db8dc0a54261
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REQUESTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN "DMDRES_LT_ORDER"."SCHEDQTY" = 0 THEN 'NOT MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY") >0 THEN 'PARTIALLY MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."REQ_DATE","DMDRES_LT_ORDER"."SCHEDDATE") > 0 THEN 'MET LATE' 
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."SCHEDDATE","DMDRES_LT_ORDER"."REQ_DATE") > 0 AND "DMDRES_LV_INDDMDLINK"."SUPPLYTYPE" <> '7' THEN 'MET EARLY' 
              ELSE 'MET' 
              END
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f521cf-991d-43b3-a357-4a9a8ae9b388
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: TIMELYQUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d00b1d5-b016-4c40-b928-055bc219f258
                stepCounter: cc3d5b28-be64-49ba-b729-34e87a20f109
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 82397710-70bd-49a7-85b8-cbe3f3911412
          stepCounter: 9a151aec-e8a1-48c8-b5fe-0e5b65e1866d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OFFSET_REQUESTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN "DMDRES_LT_ORDER"."SCHEDQTY" = 0 THEN 'NOT MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" - "DMDRES_LT_ORDER"."SCHEDQTY") >0 THEN 'PARTIALLY MET'
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."OFFSETREQDT","DMDRES_LT_ORDER"."SCHEDDATE") > 0 THEN 'MET LATE' 
              WHEN ("DMDRES_LT_ORDER"."QUANTITY" = "DMDRES_LT_ORDER"."SCHEDQTY") AND DATEDIFF(DAY,"DMDRES_LT_ORDER"."SCHEDDATE","DMDRES_LT_ORDER"."OFFSETREQDT") > 0 AND "DMDRES_LV_INDDMDLINK"."SUPPLYTYPE" <> '7' THEN 'MET EARLY' 
              ELSE 'MET' 
              END
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DMDRES_LT_DELAYEDQUANTITY: 24fe548a-f730-4eef-a74b-de17055cbe0a
          DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY: b408ef1c-9c0b-4818-89cb-d66e77706133
          DMDRES_LT_OFFSETNEEDTIMELYQTY: 9c2c9c34-c26a-4f59-8238-5a42451f9eed
          DMDRES_LT_OFFSETREQDELAYEDQUANTITY: 0b261d61-03ee-48e9-a923-1655e5ab108d
          DMDRES_LT_OFFSETREQTIMELYQTY: 45c9ab5f-1d0b-4bf0-9076-a4c73d55178f
          DMDRES_LT_ORDER: f3264f49-0e27-4db0-af51-10b8f65e49e5
          DMDRES_LT_REQDELAYEDQUANTITY: e84718b3-5120-4987-8c2a-e9b1d787080f
          DMDRES_LT_REQTIMELYQTY: 7f9d1251-9794-43be-a030-fa3e0c9055ca
          DMDRES_LT_TIMELYQUANTITY: cc3d5b28-be64-49ba-b729-34e87a20f109
          DMDRES_LV_INDDMDLINK: 4142f568-0526-481d-b037-fe8d9e229390
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_DELAYEDQUANTITY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_OFFSETNEEDTIMELYQTY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_OFFSETREQDELAYEDQUANTITY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_OFFSETREQTIMELYQTY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_ORDER
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_REQDELAYEDQUANTITY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_REQTIMELYQTY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LT_TIMELYQUANTITY
          - locationName: E_SC_TEMP
            nodeName: DMDRES_LV_INDDMDLINK
        join:
          joinCondition: |
            FROM {{ ref('E_SC_TEMP', 'DMDRES_LT_ORDER') }} "DMDRES_LT_ORDER"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LV_INDDMDLINK') }} "DMDRES_LV_INDDMDLINK"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LV_INDDMDLINK"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LV_INDDMDLINK"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LV_INDDMDLINK"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LV_INDDMDLINK"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LV_INDDMDLINK"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_TIMELYQUANTITY') }} "DMDRES_LT_TIMELYQUANTITY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_TIMELYQUANTITY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_TIMELYQUANTITY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_TIMELYQUANTITY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_TIMELYQUANTITY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_TIMELYQUANTITY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_DELAYEDQUANTITY') }} "DMDRES_LT_DELAYEDQUANTITY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_DELAYEDQUANTITY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_DELAYEDQUANTITY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_DELAYEDQUANTITY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_DELAYEDQUANTITY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_DELAYEDQUANTITY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_REQTIMELYQTY') }} "DMDRES_LT_REQTIMELYQTY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_REQTIMELYQTY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_REQTIMELYQTY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_REQTIMELYQTY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_REQTIMELYQTY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_REQTIMELYQTY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_REQDELAYEDQUANTITY') }} "DMDRES_LT_REQDELAYEDQUANTITY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_REQDELAYEDQUANTITY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_REQDELAYEDQUANTITY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_REQDELAYEDQUANTITY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_REQDELAYEDQUANTITY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_REQDELAYEDQUANTITY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_OFFSETNEEDTIMELYQTY') }} "DMDRES_LT_OFFSETNEEDTIMELYQTY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_OFFSETNEEDTIMELYQTY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_OFFSETNEEDTIMELYQTY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_OFFSETNEEDTIMELYQTY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_OFFSETNEEDTIMELYQTY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_OFFSETNEEDTIMELYQTY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY') }} "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_OFFSETNEEDDELAYEDQUANTITY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_OFFSETREQTIMELYQTY') }} "DMDRES_LT_OFFSETREQTIMELYQTY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_OFFSETREQTIMELYQTY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_OFFSETREQTIMELYQTY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_OFFSETREQTIMELYQTY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_OFFSETREQTIMELYQTY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_OFFSETREQTIMELYQTY"."LOCATION"

            LEFT JOIN {{ ref('E_SC_TEMP', 'DMDRES_LT_OFFSETREQDELAYEDQUANTITY') }} "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"
            ON "DMDRES_LT_ORDER"."SNAPSHOTDATE" = "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"."SNAPSHOTDATE" AND
            "DMDRES_LT_ORDER"."SCENARIO" = "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"."SCENARIO" AND
            "DMDRES_LT_ORDER"."ORDERID" = "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"."ORDERID" AND
            "DMDRES_LT_ORDER"."ITEM" = "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"."ITEM" AND
            "DMDRES_LT_ORDER"."LOCATION" = "DMDRES_LT_OFFSETREQDELAYEDQUANTITY"."LOCATION"
        name: DMDRES_LT_COMMON
        noLinkRefs: []
  name: DMDRES_LT_COMMON
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
