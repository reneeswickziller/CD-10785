fileVersion: 1
id: 001fd64b-3372-4a00-985d-aa48e06160ae
name: V_MAST_STAS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_TEMP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81b84116-7f29-4b87-be6f-a7459df96584
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: STLNR
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b922f16-4f4f-48a1-99c8-18f5d6ca2525
                stepCounter: eaf823fd-fd5b-4f47-84ef-3cac2dbb1d5d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3099bf07-574f-4bd5-80de-665265681147
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: BOM_USAGE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4522b00f-ed40-4012-b97b-080013bd9074
                stepCounter: eaf823fd-fd5b-4f47-84ef-3cac2dbb1d5d
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: eb9967fc-0cd5-4403-98e8-153e27eed7d0
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: PLANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFF((("V_MAST"."WERKS" IS NULL)  OR ("V_MAST"."WERKS"= '') OR ("V_MAST"."WERKS" = ' ') OR ("V_MAST"."WERKS" = '   ') OR("V_MAST"."WERKS"='    ') OR ("V_MAST"."WERKS"= '0') OR ("V_MAST"."WERKS"= '00') OR ("V_MAST"."WERKS" = '000') OR ("V_MAST"."WERKS"= '0000')),'NA',"V_MAST"."WERKS")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1dd36a64-229a-471b-9fe6-4322d953842f
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: BOM_ALT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: LPAD("V_MAST"."STLAL",2,'0')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 89e27a10-6e05-48bf-b7a6-709c0a6c9eec
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        name: MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              case when LTRIM("V_MAST".MATNR,' +.0123456789')!= '' then "V_MAST".MATNR 
                  else LPAD("V_MAST".MATNR,18,'0') end
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f39dea3b-58c8-45e4-8bd6-0b35b36aaae1
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: STLTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5621e329-73b5-4dea-a160-5e276db0a001
                stepCounter: 28d8f037-c6a7-4bb2-b875-2191c5a735f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f95eae4f-fc62-4b5d-9816-79783d02d569
          stepCounter: 001fd64b-3372-4a00-985d-aa48e06160ae
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: STLKN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ea367b-5336-439b-920e-5e4fedbae20d
                stepCounter: 28d8f037-c6a7-4bb2-b875-2191c5a735f0
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          V_AGG_STAS: 28d8f037-c6a7-4bb2-b875-2191c5a735f0
          V_MAST: 2230a1c0-a3d7-489f-8fb0-c9cab1a1a795
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: V_AGG_STAS
          - locationName: R_SAP_ECC
            nodeName: V_MAST
        join:
          joinCondition: |
            FROM {{ ref('R_SAP_ECC', 'V_MAST') }} "V_MAST"
            INNER JOIN {{ ref('E_SC_TEMP', 'V_AGG_STAS') }} "V_AGG_STAS"
            ON "V_MAST"."STLNR" = "V_AGG_STAS"."STLNR"
            and "V_MAST"."STLAL" = "V_AGG_STAS"."STLAL"
            where V_MAST."SLT_OPERATION_FLAG" != 'D'
        name: V_MAST_STAS
        noLinkRefs: []
  name: V_MAST_STAS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
