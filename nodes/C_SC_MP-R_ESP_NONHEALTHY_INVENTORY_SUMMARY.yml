fileVersion: 1
id: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
name: R_ESP_NONHEALTHY_INVENTORY_SUMMARY
operation:
  config:
    insertStrategy: UNION
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: C_SC_MP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b18a678f-753d-4e4d-bd22-62b56c02fe6f
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: SNAPSHOTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1935b83-cd72-43c6-9e26-30cf03b48669
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0416bbeb-dc5a-447c-aad0-94cffb6682a3
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: SIMULATION_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47100825-355b-48f8-9169-9ef1934641e1
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70b0e256-c60c-486e-845c-f0459c0c593a
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(32)
        description: ""
        hashDetails: null
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f336e9b1-13c8-4516-ba53-43097324ad31
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 500a2c9e-8902-40c7-a6c5-5b745724717e
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        hashDetails: null
        name: INVENTORY_HEALTH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89fd16d0-918d-4326-9b08-cb243ab2de23
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2fbb146-fea1-4d62-bbe2-a5d72a882111
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(25)
        description: ""
        hashDetails: null
        name: INVENTORY_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db021412-03c7-449b-af24-553e6d3b03c0
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e37e7ba-4238-4a3b-93b8-59a24bc96745
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        hashDetails: null
        name: PLNORD_SUPPLY_PEG_UOM_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e59b5213-395a-46d9-be32-fcefdb3e6179
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: MAX("R_ESP_NH_SUMMARY_A1"."SUPPLYPEG_UOM_QTY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d41f616-0aed-4e25-b52d-793c5a4311b7
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        hashDetails: null
        name: INVENTORY_UOM_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4735faa0-4b2a-48e3-a62d-95ed51317840
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: SUM("R_ESP_NH_SUMMARY_A1"."INVENTORY_UOM_QTY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa8ed06a-ce70-4df1-a908-fbc1e2eb4266
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: LOADDATETIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0847fd4-fedb-48d0-a1dc-d673dcd85999
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78107c48-c18a-4353-8be5-b9f7a71cbf40
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(18)
        description: ""
        hashDetails: null
        name: INVITEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9ea2b30-78ee-4343-90ff-6d780619b384
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5803ee5-4e56-435c-9269-007cded55445
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: INV_END_ITEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26e90f4d-c0ca-478d-b44b-f2095249a23c
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1abd2b1c-f5e9-46fb-88f9-204217bf4037
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        hashDetails: null
        name: INVENTORY_LOCATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8c51739-efe4-41b8-8dee-3161ec867c38
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c6b4215-c82e-40f0-9ede-e4bd7d32ffa5
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(9)
        description: ""
        hashDetails: null
        name: INVENTORY_ITEM_MATERIAL_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c4e2877-6330-42dd-b22e-7dd0b9808e64
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eb27e49-37d9-4353-8ad5-bbe3a9fde8df
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        hashDetails: null
        name: INVENTORY_SEQUENCE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ade6e5b1-cdd6-4c24-8418-edf7ed3dce90
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d127837b-2723-4c57-9203-ce66c008950d
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: INVENTORY_SUPPLY_AVAILABLE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f9a7334-5f5c-4414-ba00-8e2c62c119fc
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fe9c792-7527-42fd-aec1-7a8a0bbf4c64
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(5)
        description: ""
        hashDetails: null
        name: PLNORD_SUPPLYTYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c006df0b-d24c-44fd-aad6-fd2d1953f060
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70704553-bd99-45f1-bf15-599f20ba25b0
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        hashDetails: null
        name: INV_SUPPLY_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddb64231-e3dc-499c-b0c9-f6a8f1698432
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad2b7aa9-df3c-45ff-a9ee-4cc7190d4afb
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        hashDetails: null
        name: INVENTORY_ATP_CATEGORY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef72b18f-e472-425f-97c5-bd5cf429aa5c
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b6ad3f8-a676-446e-930d-2b6233e4952a
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        hashDetails: null
        name: INVENTORY_ITEM_DESIGN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf1abf06-65e7-49be-b04a-22b600c83c1f
                stepCounter: 0506336a-d3f2-4e3c-9272-8caf17ca3995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd91b96b-8503-473b-9407-41a80682de16
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(9)
        description: ""
        name: WORK_WEEK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c300c477-5c43-4378-968a-f543eafdc5ea
                stepCounter: 4a47d73e-1a9a-49e4-9c11-c9142effe5c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd8e60cf-9f4f-4dcf-b9a1-cf1fdcb0a0ff
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PROFIT_CENTER_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 894769f5-66ee-41f6-ae26-fed620d32cb6
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc954b33-59a3-424f-aa1d-16b2e1efab8a
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(128)
        description: ""
        name: ENTBOM_TOAD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac04a29-0461-4af9-8bea-41f704797972
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b645065-cdde-441e-8380-e19684a07bbe
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: PRODUCT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f78b2a-3c62-4532-a461-707eb137ede9
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23d18d14-fed3-49bb-b488-2b734a4525f8
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: FINANCE_BUSINESS_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afdd8fa4-84fe-440c-9a35-0c4764e904c0
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d264dc6-5f01-4b13-99c0-f22a1b785d34
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PACKAGE_HEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6325e481-ad64-4a55-bcf0-7626563e02ba
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc224689-668a-41aa-af49-4687fee6a144
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: AUTOMOTIVE_LOT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05d5c9dd-9d49-43d5-a068-bc1754e79b33
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45c0e301-96ac-414d-8714-1a3fab0c60ee
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PROBE_SHIP_PART_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2060afb-cb6e-42dd-8845-b7f2b16f494c
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8edab72b-910a-4a60-9da5-ef4d429eff68
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: RETAIL_BOUND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19ac52e0-84cc-4438-86dd-2e376d249580
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4e7648c-d192-41a8-bdde-cd8978c55cf2
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: NPI_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e249200a-3e25-4950-a88e-04682ef265d7
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e546eabc-b56d-40ac-91bb-4b3bc449f7e1
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(250)
        description: ""
        name: DEFAULT_MARKET_SEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d33a6f25-450b-4883-85e5-4869fbb59bf6
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a591cbd1-b41a-4b1b-b894-a271a5ec4630
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: SC_SUB_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 955987bf-be6f-4ce2-b246-3154047b1997
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea049786-9625-4518-8dcb-e326f670d4a9
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: MPN_BUSINESS_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 915089d1-f2aa-4f57-9005-a5ceafff4e4d
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f188401-7611-40ff-b0a5-bc0501b692fb
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: TIER_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8205b642-3121-476a-948f-3ef1c726d969
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee9f51fb-344d-45b9-a614-7845dfbc2a9f
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCT_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a53ed70-6b6e-4c78-8b67-6b7baac200a1
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7c8accc-b29b-4c15-97d3-6736d6d5c852
          stepCounter: 2b472cea-1ae5-4e77-aae5-42cf9b0a2c4d
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: EXCLUSION_STRATEGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6536d9b0-88d1-4d34-b75d-22d645484035
                stepCounter: 8179e653-b005-44c4-998e-5b27a7da7b8a
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_MD
            nodeName: D_ESP_DATE
          - locationName: E_SC_MD
            nodeName: D_ESP_MATERIAL_CHARACTERISTICS
          - locationName: E_SC_TEMP
            nodeName: R_ESP_NH_SUMMARY_A1
        join:
          joinCondition: |-
            FROM {{ ref('E_SC_TEMP', 'R_ESP_NH_SUMMARY_A1') }} "R_ESP_NH_SUMMARY_A1"
            INNER JOIN {{ ref('E_SC_MD', 'D_ESP_DATE') }} "D_ESP_DATE"
            ON "R_ESP_NH_SUMMARY_A1"."SCENARIO_DATE" = "D_ESP_DATE"."FULL_DATE"
            INNER JOIN {{ ref('E_SC_MD', 'D_ESP_MATERIAL_CHARACTERISTICS') }} "D_ESP_MATERIAL_CHARACTERISTICS"
            ON "R_ESP_NH_SUMMARY_A1"."INVITEM" = "D_ESP_MATERIAL_CHARACTERISTICS"."PRODUCT_NUMBER"
            group by all;
        name: R_ESP_NONHEALTHY_INVENTORY_SUMMARY
        noLinkRefs: []
  name: R_ESP_NONHEALTHY_INVENTORY_SUMMARY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
