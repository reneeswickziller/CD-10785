fileVersion: 1
id: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
name: TPG_DELTA
operation:
  config:
    insertStrategy: UNION ALL
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: true
  locationName: E_SC_TEMP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aef10253-3d17-4707-a130-12bf0c27d3aa
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: DATE
        description: ""
        name: SCENARIO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35a84c0e-7ba9-486d-8dc9-9ce93dbfa00b
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 35a84c0e-7ba9-486d-8dc9-9ce93dbfa00b
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83a86208-0e39-4c00-93a8-39f3825759e5
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SCENARIO_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a98ea66-d6a7-4f2d-b2ea-f4da8d5a4bf6
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 9a98ea66-d6a7-4f2d-b2ea-f4da8d5a4bf6
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be92b0ca-906d-4290-a47b-ca34d789306d
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(18)
        description: ""
        name: ITEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62948af2-9f9a-4798-9b66-fa88f68f2dca
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 62948af2-9f9a-4798-9b66-fa88f68f2dca
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d2b3c72-eed4-46d5-8c6f-6bc117de7c7d
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: LOC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d563814-09e5-4a21-b486-b753ff4febbb
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 2d563814-09e5-4a21-b486-b753ff4febbb
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de42100f-e31e-4bf3-aa2b-e54487d0d3e6
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_ATP_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 760e53f8-9998-49a7-97de-9a5199ff72b5
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 760e53f8-9998-49a7-97de-9a5199ff72b5
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a82f98-24a9-4e68-aaf3-0619f944a434
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCTIONMETHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10a51a0f-4c07-42e0-aff2-835075cf9728
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 10a51a0f-4c07-42e0-aff2-835075cf9728
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ab8c7d-ed84-4f06-b865-9ac7aa78f832
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SEQNUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01215b52-d06c-4e36-8700-d2550b39a329
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 01215b52-d06c-4e36-8700-d2550b39a329
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e76fad67-1319-4bb2-97b2-75dfae72dba9
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: DATA_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a31971ae-4ffa-48a0-ab4b-9986f760b79f
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: a31971ae-4ffa-48a0-ab4b-9986f760b79f
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ee0178-5768-4b3d-9b30-5b4c64de3eae
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LOADDATETIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05eb4b56-27c4-48c1-ac6d-bd7118b96999
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 05eb4b56-27c4-48c1-ac6d-bd7118b96999
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01d89ba-fd68-4d66-935f-85f36252b907
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1a82ba0-e9ea-4952-9cf7-9747e842d554
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: "\"TPG_SUPPLY_1\".\"QUANTITY\""
          - columnReferences:
              - columnCounter: d1a82ba0-e9ea-4952-9cf7-9747e842d554
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46c7240c-c028-4f18-84ca-c07d957b042c
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SUPPLYPEGQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "NULL"
          - columnReferences:
              - columnCounter: 087924cc-603c-4243-a35c-be756e38f2f8
                stepCounter: dd52a822-e49a-41d3-9a91-5840a0a27a26
            transform: "\"ESP_HUB_OUTPUT_V_INDDMDLINK\".\"SUPPLYPEGQTY\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7d7e235-ec50-4156-ae2c-0f982a226d7f
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: DATE
        description: ""
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 445d7d75-a735-4848-9c87-b249b7d7cb5d
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 445d7d75-a735-4848-9c87-b249b7d7cb5d
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79ae1019-57ad-4523-9191-1260f8b3dc4b
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: DATE
        description: ""
        name: SCHEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 033ca15a-2c70-4620-80b2-3c96621d7820
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
          - columnReferences:
              - columnCounter: 033ca15a-2c70-4620-80b2-3c96621d7820
                stepCounter: aac145c2-8566-49e3-8a48-9cb988ad3b76
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 504f8ec4-292a-40ef-aa3a-ed27ef36aec0
          stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
        config: {}
        dataType: DECIMAL(34,6)
        defaultValue: ""
        description: ""
        name: DELTA_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROUND((QUANTITY - SUPPLYPEGQTY),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROUND((QUANTITY - IFF(SUPPLYPEGQTY IS NULL,0,SUPPLYPEGQTY)),0)
        transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          TPG_SUPPLY_1: aac145c2-8566-49e3-8a48-9cb988ad3b76
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: TPG_SUPPLY_1
        join:
          joinCondition: |
            FROM {{ ref('E_SC_TEMP', 'TPG_SUPPLY_1') }} "TPG_SUPPLY_1"
        name: SUPPLY1
        noLinkRefs: []
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: TPG_INDDMDLINK
          - locationName: E_SC_TEMP
            nodeName: TPG_SUPPLY_1
        join:
          joinCondition: |
            FROM {{ ref('E_SC_TEMP', 'TPG_SUPPLY_1') }} "TPG_SUPPLY_1"
            LEFT OUTER JOIN (SELECT "SNAPSHOTDATE",SIMULATION_NAME,SUPPLYITEM,SUPPLYLOC,SUPPLYSEQNUM,SUM(SUPPLYPEGQTY) as SUPPLYPEGQTY,SUPPLYTYPE FROM {{ ref('E_SC_TEMP', 'TPG_INDDMDLINK') }}                                                        
            GROUP BY ALL)"ESP_HUB_OUTPUT_V_INDDMDLINK"

            ON "TPG_SUPPLY_1".SCENARIO_DATE = "ESP_HUB_OUTPUT_V_INDDMDLINK"."SNAPSHOTDATE"
            AND "TPG_SUPPLY_1".SCENARIO_NAME = "ESP_HUB_OUTPUT_V_INDDMDLINK".SIMULATION_NAME
            AND "TPG_SUPPLY_1".ITEM = "ESP_HUB_OUTPUT_V_INDDMDLINK".SUPPLYITEM
            AND "TPG_SUPPLY_1".LOC = "ESP_HUB_OUTPUT_V_INDDMDLINK".SUPPLYLOC
            AND "TPG_SUPPLY_1".SEQNUM = "ESP_HUB_OUTPUT_V_INDDMDLINK".SUPPLYSEQNUM
            AND "TPG_SUPPLY_1".SUPPLY_TYPE = "ESP_HUB_OUTPUT_V_INDDMDLINK".SUPPLYTYPE
        name: DMDLINK1
        noLinkRefs: []
  name: TPG_DELTA
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
