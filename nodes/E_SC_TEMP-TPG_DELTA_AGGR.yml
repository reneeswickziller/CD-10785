fileVersion: 1
id: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
name: TPG_DELTA_AGGR
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_TEMP
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2570d276-1ecd-45ce-93ca-4ff6e7a7d208
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: DATE
        description: ""
        name: SCENARIO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aef10253-3d17-4707-a130-12bf0c27d3aa
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcc953c3-49c4-4858-93c8-1939735035d3
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SCENARIO_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83a86208-0e39-4c00-93a8-39f3825759e5
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6873ae-cd8f-470a-ab3f-b7f5108d8b76
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(18)
        description: ""
        name: ITEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be92b0ca-906d-4290-a47b-ca34d789306d
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c331942-ca66-49f9-80a9-373a66ce9ad7
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: LOC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d2b3c72-eed4-46d5-8c6f-6bc117de7c7d
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ba541ed-f30b-44e4-80cc-3a4da32c62b3
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_ATP_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de42100f-e31e-4bf3-aa2b-e54487d0d3e6
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cd9ad07-aaab-498a-80e1-01f862869108
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCTIONMETHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a82f98-24a9-4e68-aaf3-0619f944a434
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 064a8fdb-9cf2-4d38-bca8-859d0ffeed49
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SEQNUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ab8c7d-ed84-4f06-b865-9ac7aa78f832
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f3375e-420d-43eb-befd-2fce19c3ea05
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: DATA_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e76fad67-1319-4bb2-97b2-75dfae72dba9
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f43c8063-cc85-479c-b7c9-efc2b0e5214b
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LOADDATETIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38ee0178-5768-4b3d-9b30-5b4c64de3eae
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd27fe54-5ed0-43eb-94d3-e55c6d4a02dc
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01d89ba-fd68-4d66-935f-85f36252b907
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: SUM("TPG_DELTA"."QUANTITY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eea1e212-15da-476c-9fab-4e05629a55cf
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SUPPLYPEGQTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46c7240c-c028-4f18-84ca-c07d957b042c
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: SUM("TPG_DELTA"."SUPPLYPEGQTY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 479b6e4e-bcdd-4276-9070-2f481a1fbad6
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: DATE
        description: ""
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7d7e235-ec50-4156-ae2c-0f982a226d7f
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 545040bd-c172-4161-81fa-8b588ceb5e14
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: DATE
        description: ""
        name: SCHEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79ae1019-57ad-4523-9191-1260f8b3dc4b
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2a92ddb-6761-4171-93c0-f1f31b3db9ea
          stepCounter: ba017e2e-18bc-4dd9-96a2-a21a5e8258ea
        config: {}
        dataType: DECIMAL(34,6)
        description: ""
        name: DELTA_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 504f8ec4-292a-40ef-aa3a-ed27ef36aec0
                stepCounter: ecbff65d-b8b4-4d2f-a92d-5297ebe725c8
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_TEMP
            nodeName: TPG_DELTA
        join:
          joinCondition: |-
            FROM {{ ref('E_SC_TEMP', 'TPG_DELTA') }} "TPG_DELTA"
            WHERE "TPG_DELTA"."DELTA_QTY">0
            GROUP BY ALL
        name: TPG_DELTA_AGGR
        noLinkRefs: []
  name: TPG_DELTA_AGGR
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
