fileVersion: 1
id: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
name: IND_DMD_PEGGING_CUST_PLANORD_IND_DMC_JOIN2
operation:
  config:
    insertStrategy: UNION
    postSQL: |-
      delete from {{ ref('E_SC_TEMP', 'IND_DMD_PEGGING_CUST_PLANORD_IND_DMC_JOIN2')}}

      where  SIMULATION_NAME='{{parameters.SIMUALTION_NAME}}' 
      and "LOADDATETIMESTAMP" <=(SELECT WATER_MARKER_TIMESTAMP FROM {{ ref('E_SC_UTIL_USER','LOAD_CONTROL_SC_SPO') }}

                                WHERE PROCEDURE_NAME = 'BV_SP_IND_DMD_PEGGING_INSERT'  and  SIMULATION_NAME='{{parameters.SIMULATION_NAME}}' );
    preSQL: |-
      delete from {{ ref('E_SC_TEMP', 'IND_DMD_PEGGING_CUST_PLANORD_IND_DMC_JOIN2')}}
      where
        (SNAPSHOTDATE, SIMULATION_NAME) IN (
          SELECT
            SNAPSHOT_DATE,
            SIMULATION_NAME
          FROM
            {{ ref('E_SC_SP', 'ESP_HUB_OUTPUT_V_FORECAST')}}
          where
            SIMULATION_NAME = '{{parameters.SIMULATION_NAME}}' 
          GROUP BY
            SNAPSHOT_DATE,
            SIMULATION_NAME
        );
    selectDistinct: true
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: E_SC_TEMP
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7e7477bd-1af6-4a64-a60a-151d20b63432
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COPRODFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "ESP_HUB_OUTPUT_V_PLANORDER"."COPRODORDERTYPE" = '1' THEN 'Y' ELSE 'N' END
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6660548-0cce-4f2a-a088-c29f731d2efb
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: DEMAND_PEG_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e4728a-33e3-402f-9661-fe1d14fa57c3
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd6f80e5-3bdc-41da-8757-115780b49a58
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: DEMAND_SCHEDULE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3d80405-28fc-4057-b463-f1c103d22fdf
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f6ec0340-40df-4357-ba62-9ee1b3da39c5
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DESIGN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b42916d-1eca-4d19-920c-84e7a525e236
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: DMDLOC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b44a7d8-b994-455f-a3af-86e07353ffe7
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43b43d83-caac-4a5a-bab5-63b8f55e7947
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: DMDNEEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93787181-eaa3-44dd-a5f4-d153482eaf7f
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d63c4ea9-c2e4-4b46-88a2-69979532a40d
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_ENTBOM_TOAD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 889a6802-dd5b-428d-94f8-2fcbf87cf489
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: END_PRODUCT_MATERIAL_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d42b9f6-09e4-4cd6-b509-3fbde3e616ff
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7959b347-d1d2-4c70-ae5f-ab73651971f0
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_MATERIAL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: feb54a6f-9126-41fd-8a69-2e05f2b26a32
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_MODULE_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6c92d09c-7f22-4fe6-8e0c-9b1b6d42e53d
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_PLANNING_STRATEGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7a8aec-13b9-4713-b88c-12a13b2f3f5e
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_SC_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0468e7fc-551d-468b-a1fc-04de1b3545f6
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_SC_PLANNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4abc2701-b521-409c-8725-7aca38df662e
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_SSD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5bc24f17-e339-445c-90bd-118e59078a65
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_SSD_MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 64b17037-a4c3-48d5-8363-55f6493b967a
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_TS_PLANNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 898e9a7b-0c72-4f2d-8226-b9b864d17daf
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        defaultValue: ""
        description: ""
        name: LOADDATETIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b1c384-a823-4039-bae7-d537ec11fe9b
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 428092d0-74c8-4a39-9f10-656052ae1a80
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MFG_PLANNING_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80f0b3b9-3ce2-46f6-b58e-16dcf5dbebd8
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: NEEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6a8d9cc-7434-49ab-a9b5-9579c8574efe
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e12fe6ae-c38c-4432-a7cd-6aa758b3c25f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: ORDERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5188c3a8-634b-4fce-af7b-320143b83155
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: add56fe8-e7bf-44b8-b122-079cee7693cc
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PACKAGE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97352924-f5b2-44e4-9050-0ae2c5980795
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PARENT_SUPPLY_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75ed0897-8d07-40db-a228-917d5233d0e2
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed05bb9-e0ae-4c7e-9e29-9d748362ebb8
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: PARENT_SUPPLY_SCHEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fe9595f-133f-470f-b7d2-8f3dfb410c86
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef92731-88a9-4b9d-b988-e4b30856f558
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PARENT_SUPPLY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308bdee2-7f8b-43ee-b23c-3bdd54a661db
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f10f2649-e5f3-453a-aa77-b69f10fd41b4
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: PARENT_SUPPLY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c1b54f-1a03-4ef7-a3c8-766b763b78ba
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c20f918-a178-478c-a9aa-7549e1a9a8fa
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(18)
        description: ""
        name: PRODUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb0a64b4-a10e-422e-b445-2b25ae6804a7
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9cbfdf48-1255-4b43-94d4-b05ef15c90a7
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PRODUCT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c27562ff-9df5-4073-9311-ece0eebb1249
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PRODUCT_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3ed2a58b-14bb-43d1-9d50-1431d9fe167a
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: PRODUCT_NUMBER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2402bea8-bfd5-4d9a-90de-288cd7fcfeb0
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PRODUCT_SUBTECHNOLOGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4dcc02f4-f513-4391-83f7-a1e8a8adad6a
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PRODUCT_TECHNOLOGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 885584e8-118d-409e-a544-0301c17c8d4f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PROFIT_CENTER_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e89aeea4-7220-4b91-ad66-1162e8ee5c5a
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: RELATEDSEQNUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 479747d0-0fb1-4fd8-a503-d7c920b4c8fe
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37a20089-648a-431e-b274-1bab990e1295
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: REQUIRED_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d639aacc-a7f3-414b-88fd-777ce617ad3a
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffc3e5f3-5e10-4b4f-90ab-234df7726346
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: SCHEDULE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 282464a2-1faf-4f37-996e-ad10de4b1e6b
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 74147353-e658-4b26-87dc-64c6f3a7935e
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SERIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7d0ef8b-b1f9-475d-b2ac-47e646da5f14
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SIMULATION_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d8e076-18b4-4929-9d1d-73cc371b04e2
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37a531ed-cddb-4e3a-9eb4-9bed9a57609f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: SNAPSHOTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ec97904-405b-4c6b-9cdc-7cd501622d80
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afdb0b8f-c825-4413-808e-e6f9d842aff7
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: DATE
        description: ""
        name: SUPPLY_AVAIL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4b35c6f-56cc-4825-ae4b-eb1aa37904c3
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 423c2cf0-9662-4018-90bf-bcb7e9d20860
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(9)
        description: ""
        name: SUPPLY_ITEM_MATERIAL_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b027e42-c2e8-4fb3-a8d1-feae98852944
                stepCounter: b1acad72-c964-40cb-9536-6187b3deeb87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78c1a12a-9d9e-42ea-899a-ee62f8f076a1
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(18)
        description: ""
        name: SUPPLY_ITEM_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6620521-b041-4444-a483-deb8f770817a
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ebe7f1b-6466-425a-8982-5d7d5e11a4e7
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SUPPLY_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49663a6f-2cdb-449c-ab08-f6b06faf251c
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2dc608f-d981-40b3-ad4a-b18ab638871b
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: NUMBER(34,6)
        description: ""
        name: SUPPLY_PEG_QTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e875f33a-d913-47fc-826d-fd30c2462c49
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 608af5cd-1849-49b7-88d5-45f9cd05460e
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PLANNING_STRATEGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2fa98da2-b3be-4e90-9f1c-c17a9e3667d5
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5a03e236-9b7d-4f02-b957-61bd73efa1b5
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_DESIGN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8b84d15f-7fc2-4aec-83ca-5e7c0e6c9a6f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_MPG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 48a92c08-950b-4ffc-93cb-97783fbabfa3
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_PROCUREMENT_LEAD_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "' '"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 496ad090-5968-45e4-960b-d08838974b5d
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SUPPLY_SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25923627-8f32-4dc0-956a-d126d371779c
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac51eba-3379-45e9-9756-83015b89707b
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(5)
        description: ""
        name: SUPPLY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93cc63cb-486c-4c34-9b29-f1056c0234e2
                stepCounter: 2ee0f5ba-7e83-4d68-90c2-3e1cf2c47649
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d8db38cc-c6fa-4d35-ac3d-c0fd3e68175f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_MODULE_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 058d3632-e1b8-4a1d-88fb-39f9be6717a7
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_MODULE_FORM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b8d2121d-4a52-43bb-b53c-f05387b966d1
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_MODULE_DENSITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aa3ea04e-f457-461b-9e79-00a439652ecd
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_ENTBOM_TOAD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5b8d18a2-3ac4-43c5-aa9e-7289595abaf2
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2a20b659-b2f8-48e1-8ead-9f7210a11122
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_TECHNOLOGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 886c11e6-bd33-4c54-b985-6b4d87160d53
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_FAMILY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 29c6281b-0005-475f-b089-3dbf6c9b9368
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SERIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e27b8843-4884-4e4c-99dd-5dbb700f33a2
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SSD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: df77b779-7a8e-402a-8b8f-847d315ea5c1
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SSD_MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a0a20c-4b60-43c7-91c2-fb88d90f0f2b
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: U_PPLEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3961ded-5374-4445-a797-54a173af46a2
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46763592-4018-49fc-b882-b139758fd5c4
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_SEGMENTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da467b6f-44c0-4a9b-a018-c06f2bd71abc
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f715457e-6d77-476b-be1a-9460ff676942
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: NUMBER(34,9)
        description: ""
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49d678fc-4b6c-4326-a190-48bb19bc49c3
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e4f110e-e61e-4603-8314-26aff55fc95b
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: U_INDDMD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359f9a13-f464-4352-a33f-f2317c5677cd
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 357d90dc-e33d-4806-9f19-a84fc5f67d2f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SUBTECHNOLOGY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0027af27-d621-4e00-bc50-95be2f453219
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SC_SUB_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 708ce72e-782a-45e5-95cf-d0db0887cd2c
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PROFIT_CENTER_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9578d9f3-c539-463e-99b8-daef8e928496
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SC_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e52d027-e28f-4da8-b70a-f985149076e7
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: U_ATP_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6e3b588-7cae-4025-b6cd-ec5275051f11
                stepCounter: 7d7d04a7-73ff-4299-b97a-4012569774af
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ac08f434-b592-42ac-aefb-a7235db27719
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_TS_PLANNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a558e6c2-5dad-43c0-989d-5235d41c678f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_SC_PLANNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ebe54789-6ba4-4cb3-9add-d78e58208329
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_SC_SUB_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b739efff-c515-4d93-947c-a9061ac7ebe3
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_MATERIAL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bc9adc44-0978-4c6b-9dbb-dd7e142e031f
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SUPPLY_PRODUCT_PROJECT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: da5adcff-1093-417e-a311-0fc3bf394f73
          stepCounter: 7a89ca93-b9cd-4da5-b484-2fb22d41c42a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: END_PRODUCT_PROJECT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "''"
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: E_SC_MD
            nodeName: D_ESP_MATERIAL_CHARACTERISTICS
          - locationName: E_SC_SP
            nodeName: ESP_HUB_OUTPUT_V_FORECAST
          - locationName: E_SC_SP
            nodeName: ESP_HUB_OUTPUT_V_PLANORDER
          - locationName: E_SC_TEMP
            nodeName: INDDMDPEGGING_INDDMDLINK_LOAD
          - locationName: E_SC_UTIL_USER
            nodeName: LOAD_CONTROL_SC_SPO
        join:
          joinCondition: |-

            FROM {{ ref('E_SC_TEMP', 'INDDMDPEGGING_INDDMDLINK_LOAD') }} "INDDMDPEGGING_INDDMDLINK_LOAD"
            LEFT JOIN {{ ref('E_SC_MD', 'D_ESP_MATERIAL_CHARACTERISTICS') }} "D_ESP_MATERIAL_CHARACTERISTICS"
            ON "INDDMDPEGGING_INDDMDLINK_LOAD"."SUPPLYITEM" = "D_ESP_MATERIAL_CHARACTERISTICS"."PRODUCT_NUMBER"
            LEFT JOIN {{ ref('E_SC_SP', 'ESP_HUB_OUTPUT_V_PLANORDER') }} "ESP_HUB_OUTPUT_V_PLANORDER"
            ON "INDDMDPEGGING_INDDMDLINK_LOAD"."SNAPSHOTDATE" = "ESP_HUB_OUTPUT_V_PLANORDER"."SNAPSHOTDATE"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."SIMULATION_NAME" = "ESP_HUB_OUTPUT_V_PLANORDER"."SIMULATION_NAME"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."SUPPLYSEQNUM" = "ESP_HUB_OUTPUT_V_PLANORDER"."SEQNUM"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."SUPPLYITEM" = "ESP_HUB_OUTPUT_V_PLANORDER"."ITEM"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."SUPPLYLOC" = "ESP_HUB_OUTPUT_V_PLANORDER"."LOC"
            LEFT JOIN {{ ref('E_SC_SP', 'ESP_HUB_OUTPUT_V_FORECAST') }} "ESP_HUB_OUTPUT_V_FORECAST"
            ON "INDDMDPEGGING_INDDMDLINK_LOAD"."DMDSEQNUM" = "ESP_HUB_OUTPUT_V_FORECAST"."SEQNUM"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."DMDITEM" = "ESP_HUB_OUTPUT_V_FORECAST"."ITEM"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."DMDLOC" = "ESP_HUB_OUTPUT_V_FORECAST"."LOC"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."DMDNEEDDATE" = "ESP_HUB_OUTPUT_V_FORECAST"."NEEDDATE"
            AND "INDDMDPEGGING_INDDMDLINK_LOAD"."SIMULATION_NAME" = "ESP_HUB_OUTPUT_V_FORECAST"."SIMULATION_NAME"
            AND TO_DATE("INDDMDPEGGING_INDDMDLINK_LOAD"."SNAPSHOTDATE") = "ESP_HUB_OUTPUT_V_FORECAST"."SNAPSHOT_DATE"

            WHERE 
            "INDDMDPEGGING_INDDMDLINK_LOAD"."DMDTYPE" = '2'
            AND "ESP_HUB_OUTPUT_V_FORECAST"."SIMULATION_NAME"='{{parameters.SIMULATION_NAME}}' 
            and "ESP_HUB_OUTPUT_V_FORECAST"."LOAD_DATE_TIME">(SELECT WATER_MARKER_TIMESTAMP FROM {{ ref('E_SC_UTIL_USER','LOAD_CONTROL_SC_SPO') }}
                                                                    WHERE PROCEDURE_NAME = 'BV_SP_IND_DMD_PEGGING_INSERT' AND SCENARIO_NAME='{{parameters.SIMULATION_NAME}}')
            GROUP BY ALL
        name: IND_DMD_PEGGING_CUST_PLANORD_IND_DMC_JOIN2
        noLinkRefs: []
  name: IND_DMD_PEGGING_CUST_PLANORD_IND_DMC_JOIN2
  overrideSQL: false
  schema: ""
  sqlType: persistentStage
  type: sql
  version: 1
type: Node
